(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{398:function(t,s,a){"use strict";a.r(s);var n=a(42),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"_08-jwt-实现-token-验证"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_08-jwt-实现-token-验证"}},[t._v("#")]),t._v(" [08] JWT 实现 token 验证")]),t._v(" "),a("p",[a("em",[t._v("2021 年 2 月 15 日")])]),t._v(" "),a("hr"),t._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#_08-jwt-实现-token-验证"}},[t._v("[08] JWT 实现 token 验证")]),a("ul",[a("li",[a("a",{attrs:{href:"#基于服务器的身份认证-session"}},[t._v("基于服务器的身份认证(session)")])]),a("li",[a("a",{attrs:{href:"#基于-token-的身份认证-json-web-token"}},[t._v("基于 Token 的身份认证(JSON Web Token)")]),a("ul",[a("li",[a("a",{attrs:{href:"#json-web-token-应用场景"}},[t._v("JSON Web Token 应用场景")])]),a("li",[a("a",{attrs:{href:"#json-web-token-由三部分组成-用圆点-连接。"}},[t._v("JSON Web Token 由三部分组成，用圆点(.)连接。")])])])]),a("li",[a("a",{attrs:{href:"#git-和-qq-登录状态-了解"}},[t._v("git 和 qq 登录状态(了解)")])]),a("li",[a("a",{attrs:{href:"#流程"}},[t._v("流程")])]),a("li",[a("a",{attrs:{href:"#实现"}},[t._v("实现")])]),a("li",[a("a",{attrs:{href:"#注意事项"}},[t._v("注意事项")])])])]),a("li",[a("a",{attrs:{href:"#"}})])])]),a("p"),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://jwt.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("JWT 官网"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.jianshu.com/p/719719ff6e8a",target:"_blank",rel:"noopener noreferrer"}},[t._v("JWT 实现 token 验证——简书"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.jianshu.com/p/576dbf44b2ae",target:"_blank",rel:"noopener noreferrer"}},[t._v("什么是 JWT -- JSON WEB TOKEN——简书"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/86937325",target:"_blank",rel:"noopener noreferrer"}},[t._v("5 分钟带你了解啥是 JWT——知乎"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("JSON Web Token (JWT)执行的一种基于 JSON 的开放标准(RFC 7519)，它定义了一种紧凑的、自包含的方式，用于作为 JSON 对象在各方之间安全地传输信息。该信息可以被验证和信任，因为它是数字签名的。")])]),t._v(" "),a("h2",{attrs:{id:"基于服务器的身份认证-session"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基于服务器的身份认证-session"}},[t._v("#")]),t._v(" 基于服务器的身份认证(session)")]),t._v(" "),a("p",[t._v("采用 cookie 机制，会有一台服务器专门做池子，所有的服务器都还要往这个服务器去询问，这个 cookie 是不是有效的\n如果服务器多，那个 cookie 服务器就会很累\njwt 就不需要主服务器了，每个服务器都可以独立解密")]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[t._v("原理")])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("http 协议本身是一种无状态的协议")]),t._v("，用户提供了用户名和密码来进行用户认证，下一次请求时，用户还要再一次进行用户认证才行。")])]),t._v(" "),a("li",[a("p",[t._v("为了能识别是哪个用户发出的请求，在服务器存储用户登录的信息，在响应时传递给浏览器，告诉其保存为 cookie,下次请求时发送给服务器，这样服务器就能识别请求来自哪个用户了,这就是传统的基于 session 认证。")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("采用 cookie 机制，会有一台服务器专门做池子，所有的服务器都还要往这个服务器去询问当前 cookie 的有效性，如果服务器多，那个 cookie 服务器就会很累。")])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("缺点")])])]),t._v(" "),a("li",[a("p",[t._v("随着不同客户端用户的增加，"),a("strong",[t._v("服务端的开销会明显增大")]),t._v("，独立的服务器已无法承载更多的用户。")])]),t._v(" "),a("li",[a("p",[t._v("扩展性: 用户认证之后，服务端做认证记录并保存在其内存中，用户下次请求还必须要请求在这台服务器上,才能拿到授权的资源，而在分布式的应用上则限制了负载均衡器的能力。这也意味着限制了应用的扩展能力。")])]),t._v(" "),a("li",[a("p",[t._v("CSRF 跨站请求伪造：因为是基于 cookie 来进行用户识别的, "),a("strong",[t._v("cookie 如果被截获，用户就会很容易受到跨站请求伪造的攻击")]),t._v("。")])])]),t._v(" "),a("h2",{attrs:{id:"基于-token-的身份认证-json-web-token"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基于-token-的身份认证-json-web-token"}},[t._v("#")]),t._v(" 基于 Token 的身份认证(JSON Web Token)")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("特点")])]),t._v(" "),a("li",[t._v("基于 Token 的身份认证是"),a("strong",[t._v("无状态的")]),t._v("，"),a("strong",[t._v("服务器或者 Session 中不会存储任何用户信息")]),t._v("，服务器没有那个登记身份“池子”。")]),t._v(" "),a("li",[a("strong",[t._v("优点")])]),t._v(" "),a("li",[t._v("基于 token 的鉴权机制"),a("strong",[t._v("不需要在服务端去保留用户的认证信息或者会话信息")]),t._v("。用户不需要去考虑哪一台设备登录，这为扩展提供了便利。特别适用于分布式站点的单点登录（SSO）场景。")]),t._v(" "),a("li",[a("strong",[t._v("json 的通用")]),t._v("性，所以 JWT 是可以进行跨语言支持的，像 JAVA,JavaScript,NodeJS,PHP 等很多语言都可以使用。")]),t._v(" "),a("li",[t._v("因为有 payload 部分，JWT 可以在自身"),a("strong",[t._v("存储一些其他业务逻辑所必要的非敏感信息")]),t._v("。")]),t._v(" "),a("li",[t._v("便于传输，jwt 的构成非常简单，"),a("strong",[t._v("字节占用很小，非常便于传输")]),t._v("的。")]),t._v(" "),a("li",[a("strong",[t._v("缺点")])]),t._v(" "),a("li",[a("strong",[t._v("jwt 一旦签发出去，无法回收回来，而 cookie 机制只要池子里把你抹杀，你的 cookie 直接作废")])]),t._v(" "),a("li",[t._v("jwt 无法拉黑，因为这段"),a("strong",[t._v("字符串是固定的，一定有效")])]),t._v(" "),a("li",[t._v("这里的关键是，服务器想拉黑某个用户，"),a("strong",[t._v("拉黑不了")]),t._v("，cookie 直接删了，登录就失效了，一般会混入时间戳来做时间有效期验证，但是如果时间尚未失效，就无法拉黑。")]),t._v(" "),a("li",[t._v("没有混入 ip 地址或者设备信息时，"),a("strong",[t._v("客户可以手动把 jwt 复制走，去哪里都是登录状态")])]),t._v(" "),a("li",[a("strong",[t._v("安全性")])]),t._v(" "),a("li",[t._v("不应该在 jwt 的 payload 部分存放敏感信息，因为该部分是客户端可解密的部分。")]),t._v(" "),a("li",[t._v("保护好 secret 私钥，该私钥非常重要。")]),t._v(" "),a("li",[t._v("如果可以，请使用 https 协议")])]),t._v(" "),a("h3",{attrs:{id:"json-web-token-应用场景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#json-web-token-应用场景"}},[t._v("#")]),t._v(" JSON Web Token 应用场景")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("Authorization (授权)")]),t._v(" : 这是使用 JWT 的最常见场景。一旦"),a("strong",[t._v("用户登录")]),t._v("，后续每个请求都将包含 JWT，允许用户访问该令牌允许的路由、服务和资源。单点登录是现在广泛使用的 JWT 的一个特性，因为它的开销很小，并且可以轻松地跨域使用。")]),t._v(" "),a("li",[a("strong",[t._v("Information Exchange (信息交换)")]),t._v(" : 对于安全的在各方之间传输信息而言，JSON Web Tokens 无疑是一种很好的方式。因为 JWT 可以被签名，例如，用公钥/私钥对，你可以确定发送人就是它们所说的那个人。另外，由于签名是使用头和有效负载计算的，您还可以验证内容没有被篡改。")])]),t._v(" "),a("h3",{attrs:{id:"json-web-token-由三部分组成-用圆点-连接。"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#json-web-token-由三部分组成-用圆点-连接。"}},[t._v("#")]),t._v(" JSON Web Token 由三部分组成，用圆点(.)连接。")]),t._v(" "),a("ul",[a("li",[t._v("三部分是三段字符串。用小数点分割")])]),t._v(" "),a("ol",[a("li",[t._v("Header")]),t._v(" "),a("li",[t._v("Payload")]),t._v(" "),a("li",[t._v("Signature")])]),t._v(" "),a("ul",[a("li",[t._v("一个典型的 JWT 看起来是这个样子的：")]),t._v(" "),a("li",[a("code",[t._v("xxxxx.yyyyy.zzzzz")])]),t._v(" "),a("li",[t._v("第一段和第二段经过加密会获得第三段")]),t._v(" "),a("li",[t._v("解密出来就是你的身份信息了")]),t._v(" "),a("li",[a("strong",[t._v("服务器只要知道加密解密方式")]),t._v("就可以了")]),t._v(" "),a("li",[t._v("加密里会"),a("strong",[t._v("混入时间戳来保证整个字符串独一无二")]),t._v("，并且也能通过时间来保证 jwt 的"),a("strong",[t._v("时间有效性")]),t._v("，时间到期之前，服务器无法做出拉黑行为")]),t._v(" "),a("li",[t._v("客户手动把 jwt 复制走，去哪里都是登录状态，所以 jwt 一般还要"),a("strong",[t._v("混入 ip 地址")]),t._v("，用 "),a("strong",[t._v("ip+时间戳+用户 id")]),t._v(" 来加密")])]),t._v(" "),a("h2",{attrs:{id:"git-和-qq-登录状态-了解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#git-和-qq-登录状态-了解"}},[t._v("#")]),t._v(" git 和 qq 登录状态(了解)")]),t._v(" "),a("ul",[a("li",[t._v("有些应用是有和浏览器合作的，让 chrome 动用系统权限帮忙读取你电脑的文件")]),t._v(" "),a("li",[t._v("例如：")]),t._v(" "),a("li",[t._v("git 官网让 chrome 去读你电脑的 git config")]),t._v(" "),a("li",[t._v("还有 qq 的快捷登录，也是 chrome 帮忙的，chrome 读取进程里的 qq，就知道 qq 了")])]),t._v(" "),a("h2",{attrs:{id:"流程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#流程"}},[t._v("#")]),t._v(" 流程")]),t._v(" "),a("ul",[a("li",[t._v("用户使用用户名密码来请求服务器")]),t._v(" "),a("li",[t._v("服务器进行验证用户的信息")]),t._v(" "),a("li",[t._v("服务器通过验证发送给用户一个 token")]),t._v(" "),a("li",[t._v("客户端存储 token，并在每次请求时附送上这个 token 值")]),t._v(" "),a("li",[t._v("服务端验证 token 值，并返回数据")]),t._v(" "),a("li",[t._v("这个 token 必须要在每次请求时传递给服务端，它应该"),a("strong",[t._v("保存在请求头")]),t._v("里， 另外，"),a("strong",[t._v("服务端要支持 CORS(跨来源资源共享 Access-Control-Allow-Origin)策略")]),t._v("。")])]),t._v(" "),a("h2",{attrs:{id:"实现"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实现"}},[t._v("#")]),t._v(" 实现")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("httpRequest "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" type "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"get"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" errorTitle "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" method "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toLowerCase")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果token存在就携带在请求头一并发送出去")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("localStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("token"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_axiosInstance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("defaults"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("headers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("common"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Authorization"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n      localStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("token"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Promise")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resolve"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" reject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    instance\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        method"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        params"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" method "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"get"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" data "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" method "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"get"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" data "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("res")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//这里的status是和后端约定的")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ok"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("token"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            localStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("token "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("token"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("catch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 出错时打印错误")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" tip "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"请求"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" errorTitle "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"失败"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("finally")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br"),a("span",{staticClass:"line-number"},[t._v("31")]),a("br"),a("span",{staticClass:"line-number"},[t._v("32")]),a("br"),a("span",{staticClass:"line-number"},[t._v("33")]),a("br"),a("span",{staticClass:"line-number"},[t._v("34")]),a("br")])]),a("h2",{attrs:{id:"注意事项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#注意事项"}},[t._v("#")]),t._v(" 注意事项")]),t._v(" "),a("ul",[a("li",[t._v("登录验证：请求前要设置请求头带上 token")]),t._v(" "),a("li",[t._v("登录成功：响应成功接到响应后要保存 token")]),t._v(" "),a("li",[t._v("注销登录：注销成功响应后要将 token 手动删除")]),t._v(" "),a("li",[t._v("由于登陆验证时设置了带上 token 的请求头，为了保证当不是登陆验证时不会把 token 请求头携带出去,每次非登陆验证请求前都要先把 token 请求头移除。")])]),t._v(" "),a("h1",{attrs:{id:""}},[a("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")])]),t._v(" "),a("hr"),t._v(" "),a("p",[a("em",[t._v("Copyright © 2020 - 2021 by 叶旭瑶 . All Rights Reserved .")])])])}),[],!1,null,null,null);s.default=e.exports}}]);