(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{393:function(t,s,a){"use strict";a.r(s);var n=a(42),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"_03-xmlhttprequest-请求与-ajax-封装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_03-xmlhttprequest-请求与-ajax-封装"}},[t._v("#")]),t._v(" [03] XMLHttpRequest 请求与 AJAX 封装")]),t._v(" "),a("p",[a("em",[t._v("2021 年 1 月 10 日")])]),t._v(" "),a("hr"),t._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#_03-xmlhttprequest-请求与-ajax-封装"}},[t._v("[03] XMLHttpRequest 请求与 AJAX 封装")]),a("ul",[a("li",[a("a",{attrs:{href:"#_1-相关基础"}},[t._v("1.相关基础")]),a("ul",[a("li",[a("a",{attrs:{href:"#请求与响应"}},[t._v("请求与响应")]),a("ul",[a("li",[a("a",{attrs:{href:"#_1、请求的格式【request】"}},[t._v("1、请求的格式【request】")])]),a("li",[a("a",{attrs:{href:"#_2、响应的格式【response】"}},[t._v("2、响应的格式【response】")])]),a("li",[a("a",{attrs:{href:"#_3、get-请求和-post-请求的区别"}},[t._v("3、GET 请求和 POST 请求的区别")])])])]),a("li",[a("a",{attrs:{href:"#如何发请求"}},[t._v("如何发请求？")])])])]),a("li",[a("a",{attrs:{href:"#_2-ajax"}},[t._v("2.AJAX")]),a("ul",[a("li",[a("a",{attrs:{href:"#ajax-定义"}},[t._v("AJAX 定义")])]),a("li",[a("a",{attrs:{href:"#xmlhttprequest-构造函数"}},[t._v("XMLHttpRequest 构造函数")])]),a("li",[a("a",{attrs:{href:"#使用-xmlhttprequest-发请求"}},[t._v("使用 XMLHttpRequest 发请求")]),a("ul",[a("li",[a("a",{attrs:{href:"#_1-request-open-配置"}},[t._v("① request.open() 配置")])]),a("li",[a("a",{attrs:{href:"#_2-查看-request-的-api"}},[t._v("② 查看 request 的 API")])]),a("li",[a("a",{attrs:{href:"#_3-request-readystate"}},[t._v("③ request.readyState")])]),a("li",[a("a",{attrs:{href:"#_4-request-onreadystatechange-监听状态改变"}},[t._v("④ request.onreadystatechange 监听状态改变")])]),a("li",[a("a",{attrs:{href:"#_5-request-setrequestheader-header-value-设置请求头"}},[t._v("⑤ request.setRequestHeader(header, value)设置请求头")])]),a("li",[a("a",{attrs:{href:"#_6-request-send-body-设置请求体并将请求发送到服务器"}},[t._v("⑥ request.send(body) 设置请求体并将请求发送到服务器")])]),a("li",[a("a",{attrs:{href:"#_7-获取响应内容"}},[t._v("⑦ 获取响应内容")])]),a("li",[a("a",{attrs:{href:"#_8-总结"}},[t._v("⑧ 总结：")])])])])])]),a("li",[a("a",{attrs:{href:"#_3-json"}},[t._v("3.JSON")]),a("ul",[a("li",[a("a",{attrs:{href:"#json-的发明"}},[t._v("JSON 的发明")])]),a("li",[a("a",{attrs:{href:"#json-语法"}},[t._v("JSON 语法")])]),a("li",[a("a",{attrs:{href:"#json-使用"}},[t._v("JSON 使用")])]),a("li",[a("a",{attrs:{href:"#json-相关-api"}},[t._v("JSON 相关 API")]),a("ul",[a("li",[a("a",{attrs:{href:"#处理服务器响应的-json-字符串"}},[t._v("处理服务器响应的 json 字符串")])]),a("li",[a("a",{attrs:{href:"#js-对象-与-json-字符串-相互转化"}},[t._v("JS 对象 与 JSON 字符串 相互转化")])])])])])]),a("li",[a("a",{attrs:{href:"#_4-跨域问题"}},[t._v("4.跨域问题")]),a("ul",[a("li",[a("a",{attrs:{href:"#ajax-不能跨域请求"}},[t._v("AJAX 不能跨域请求")])]),a("li",[a("a",{attrs:{href:"#同源策略"}},[t._v("同源策略")])]),a("li",[a("a",{attrs:{href:"#让-ajax-可以跨域请求"}},[t._v("让 AJAX 可以跨域请求")])]),a("li",[a("a",{attrs:{href:"#ajax-与-jsonp-比较"}},[t._v("AJAX 与 JSONP 比较")])])])]),a("li",[a("a",{attrs:{href:"#_5-promise"}},[t._v("5.Promise")]),a("ul",[a("li",[a("a",{attrs:{href:"#jquery-的-promise"}},[t._v("jQuery 的 Promise")])]),a("li",[a("a",{attrs:{href:"#自己封装实现-promise"}},[t._v("自己封装实现 Promise")])])])])])])])]),a("p"),t._v(" "),a("p",[t._v("前言：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("1999 年，允许 JavaScript 脚本向服务器发起 HTTP 请求。")])]),t._v(" "),a("li",[a("p",[t._v("2005 年 2 月，AJAX 这个词第一次正式提出。")])]),t._v(" "),a("li",[a("p",[t._v("AJAX (Asynchronous JavaScript and XML 译：异步的 JavaScript 和 XML)，指通过 JavaScript 的异步通信，从服务器获取 XML 文档从中提取数据，再更新当前网页的对应部分，而不用刷新整个网页。")])]),t._v(" "),a("li",[a("p",[t._v("后来，AJAX 这个词就成为 JavaScript 脚本发起 HTTP 通信的代名词，也就是说，只要用脚本发起通信，就可以叫做 AJAX 通信。")])]),t._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://javascript.ruanyifeng.com/bom/ajax.html#toc0",target:"_blank",rel:"noopener noreferrer"}},[t._v("JavaScript 标准参考教程 > 浏览器环境 > AJAX —— 阮一峰"),a("OutboundLink")],1)])]),t._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://wangdoc.com/javascript/bom/xmlhttprequest.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("网道 —— XMLHttpRequest 对象"),a("OutboundLink")],1)])])]),t._v(" "),a("p",[t._v("摘要：")]),t._v(" "),a("ol",[a("li",[t._v("创建 XMLHttpRequest 实例")]),t._v(" "),a("li",[t._v("发出 HTTP 请求")]),t._v(" "),a("li",[t._v("接收服务器传回的数据")]),t._v(" "),a("li",[t._v("更新网页数据")])]),t._v(" "),a("h2",{attrs:{id:"_1-相关基础"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-相关基础"}},[t._v("#")]),t._v(" 1.相关基础")]),t._v(" "),a("h3",{attrs:{id:"请求与响应"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#请求与响应"}},[t._v("#")]),t._v(" 请求与响应")]),t._v(" "),a("h4",{attrs:{id:"_1、请求的格式【request】"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、请求的格式【request】"}},[t._v("#")]),t._v(" 1、请求的格式【request】")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("1 动词 路径协议/版本\n2 Key1: value1\n2 Key2: value2\n2 Key3: value3\n2 Content-Type: application/x-www-form-urlencoded\n2 Host: www.baidu.com\n2 User-Agent: curl/7.54.0\n3\n4 要上传的数据\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])]),a("p",[t._v("注意：")]),t._v(" "),a("ol",[a("li",[t._v("动词： GET POST PUT PATCH DELETE HEAD OPTIONS 等;")]),t._v(" "),a("li",[t._v("路径包括「查询参数」，不包括「锚点」,如果没写路径，那么路径默认为 /")]),t._v(" "),a("li",[t._v("第 2 部分中的 Content-Type 标注了第 4 部分的格式")]),t._v(" "),a("li",[t._v("第三部分永远都是一个回车（\\n）")]),t._v(" "),a("li",[t._v("OPTIONS 请求：")])]),t._v(" "),a("p",[t._v("OPTIONS 请求方法的主要用途有两个：")]),t._v(" "),a("ul",[a("li",[t._v("获取服务器支持的 HTTP 请求方法；")]),t._v(" "),a("li",[t._v("用来检查服务器的性能。")])]),t._v(" "),a("p",[t._v("Preflighted Requests(预检请求)是 CORS 中一种透明服务器验证机制。\n首先需要向另外一个域名的资源发送一个 HTTP OPTIONS 请求头，其目的就是为了判断实际发送的请求是否是安全的。下面的 2 种情况需要进行预检：")]),t._v(" "),a("ul",[a("li",[t._v("简单请求，比如使用 Content-Type 为 application/xml 或 text/xml 的 POST 请求；")]),t._v(" "),a("li",[t._v("中设置自定义头，比如 X-JSON、X-MENGXIANHUI 等。")])]),t._v(" "),a("h4",{attrs:{id:"_2、响应的格式【response】"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、响应的格式【response】"}},[t._v("#")]),t._v(" 2、响应的格式【response】")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("1 协议/版本号 状态码状态 解释\n2 Key1: value1\n2 Key2: value2\n2 Content-Length: 17931\n2 Content-Type: text/html\n3\n4 要下载的内容\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("p",[t._v("注意：")]),t._v(" "),a("ol",[a("li",[t._v("状态码(服务器对浏览器说的话):\n"),a("ul",[a("li",[t._v("1xx 不常用")]),t._v(" "),a("li",[t._v("2xx 表示成功")]),t._v(" "),a("li",[t._v("3xx 表示滚吧")]),t._v(" "),a("li",[t._v("4xx 客户端出错")]),t._v(" "),a("li",[t._v("5xx 服务器出错")])])]),t._v(" "),a("li",[t._v("第 2 部分中的 Content-Type 标注了第 4 部分的格式")]),t._v(" "),a("li",[t._v("第三部分永远都是一个回车（\\n）")])]),t._v(" "),a("h4",{attrs:{id:"_3、get-请求和-post-请求的区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、get-请求和-post-请求的区别"}},[t._v("#")]),t._v(" 3、GET 请求和 POST 请求的区别")]),t._v(" "),a("p",[t._v("1、GET 请求常用于不上传数据时，上传数据时默认将数据携带于 URL 中\n2、POST 请求常用与上传数据时，上传数据默认将数据携带在请求的第 4 部分")]),t._v(" "),a("h3",{attrs:{id:"如何发请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#如何发请求"}},[t._v("#")]),t._v(" 如何发请求？")]),t._v(" "),a("ol",[a("li",[t._v("用 form 可以发请求，但是会刷新页面或新开页面")]),t._v(" "),a("li",[t._v("用 a 可以发 get 请求，但是也会刷新页面或新开页面")]),t._v(" "),a("li",[t._v("用 img 可以发 get 请求，但是只能以图片的形式展示")]),t._v(" "),a("li",[t._v("用 link 可以发 get 请求，但是只能以 CSS、favicon 的形式展示")]),t._v(" "),a("li",[t._v("用 script 可以发 get 请求，但是只能以脚本的形式运行")])]),t._v(" "),a("h2",{attrs:{id:"_2-ajax"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-ajax"}},[t._v("#")]),t._v(" 2.AJAX")]),t._v(" "),a("h3",{attrs:{id:"ajax-定义"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ajax-定义"}},[t._v("#")]),t._v(" AJAX 定义")]),t._v(" "),a("p",[t._v("Jesse James Garrett 将使用如下 3 个技术：")]),t._v(" "),a("ol",[a("li",[t._v("使用 XMLHttpRequest 发请求")]),t._v(" "),a("li",[t._v("服务器返回 XML 格式的字符串（最初是用来传 XML 格式的）")]),t._v(" "),a("li",[t._v("JS 解析 XML，并更新局部页面")])]),t._v(" "),a("p",[t._v("的方案取名叫做 AJAX：Asynchronous JavaScript and XML(异步的 JavaScript 和 XML)")]),t._v(" "),a("h3",{attrs:{id:"xmlhttprequest-构造函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xmlhttprequest-构造函数"}},[t._v("#")]),t._v(" XMLHttpRequest 构造函数")]),t._v(" "),a("p",[a("code",[t._v("window.XMLHttpRequest")]),t._v("是一个对象/构造函数")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 查看 XMLHttpRequest 的 API")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("XXX")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("XMLHttpRequest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("XXX")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("h3",{attrs:{id:"使用-xmlhttprequest-发请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-xmlhttprequest-发请求"}},[t._v("#")]),t._v(" 使用 XMLHttpRequest 发请求")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("yexy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("button"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"click"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" request "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("XMLHttpRequest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"GET"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/yyyexy"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置")]),t._v("\n  request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setRequestHeader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Content-Type"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"application/x-www-form-urlencoded"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 设置请求头")]),t._v("\n  request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 设置第4部分，发送请求")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br")])]),a("h4",{attrs:{id:"_1-request-open-配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-request-open-配置"}},[t._v("#")]),t._v(" ① request.open() 配置")]),t._v(" "),a("p",[a("strong",[t._v("用于设置 请求方法/URL")])]),t._v(" "),a("div",{staticClass:"language-ts line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n            method"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            url"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("boolean")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 是否异步，默认异步")]),t._v("\n            user"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            password"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("p",[a("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest/open",target:"_blank",rel:"noopener noreferrer"}},[t._v("XMLHttpRequest.open()——MDN"),a("OutboundLink")],1)]),t._v(" "),a("h4",{attrs:{id:"_2-查看-request-的-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-查看-request-的-api"}},[t._v("#")]),t._v(" ② 查看 request 的 API")]),t._v(" "),a("p",[a("code",[t._v("console.log(request)")]),t._v("得到"),a("code",[t._v("XMLHttpRequest { … }")]),t._v("对象 API 如下：")]),t._v(" "),a("div",{staticClass:"language-ts line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 监听状态")]),t._v("\nonabort"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 被中断")]),t._v("\nonerror"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//加载错误")]),t._v("\nonload"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 加载成功")]),t._v("\nonloadend"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("\nonloadstart"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("\nonprogress"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("\nonreadystatechange"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("\nontimeout"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//超时")]),t._v("\nreadyState"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 读取进度")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 响应内容")]),t._v("\nresponse"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"呜呜呜，我收到 AJAX 请求了"')]),t._v("\nresponseText"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"呜呜呜，我收到 AJAX 请求了"')]),t._v("\nresponseType"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\nresponseURL"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"localhost:8888/yyyexy"')]),t._v("\nresponseXML"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 状态码")]),t._v("\nstatus"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v("\nstatusText"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"OK"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 请求超时前等待的毫秒数")]),t._v("\ntimeout"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n\nupload"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" XMLHttpRequestUpload "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" … "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  onabort"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("\n  onerror"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("\n  onload"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("\n  onloadend"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("\n  onloadstart"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("\n  onprogress"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("\n  ontimeout"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("\n  __proto__"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" XMLHttpRequestUpload\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 是否跨域请求")]),t._v("\nwithCredentials"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 原型")]),t._v("\n__proto__"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" XMLHttpRequest\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br"),a("span",{staticClass:"line-number"},[t._v("31")]),a("br"),a("span",{staticClass:"line-number"},[t._v("32")]),a("br"),a("span",{staticClass:"line-number"},[t._v("33")]),a("br"),a("span",{staticClass:"line-number"},[t._v("34")]),a("br"),a("span",{staticClass:"line-number"},[t._v("35")]),a("br"),a("span",{staticClass:"line-number"},[t._v("36")]),a("br"),a("span",{staticClass:"line-number"},[t._v("37")]),a("br"),a("span",{staticClass:"line-number"},[t._v("38")]),a("br"),a("span",{staticClass:"line-number"},[t._v("39")]),a("br")])]),a("h4",{attrs:{id:"_3-request-readystate"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-request-readystate"}},[t._v("#")]),t._v(" ③ request.readyState")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[t._v("值")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("状态")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("0")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("UNSENT(未打开)")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("代理被创建，但尚未调用 open() 方法。")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("OPENED(未发送)")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("open() 方法已经被调用，但尚未调用 send() 方法。")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("2")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("HEADERS_RECEIVED(已获取响应头)")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("send() 方法已经被调用，并且头部和状态已经可获得。")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("3")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("LOADING(正在下载响应体)")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("响应体下载中； responseText 属性已经包含部分数据。")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("4")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("DONE(请求完成)")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("下载操作已完成。")])])])]),t._v(" "),a("p",[t._v("细节：")]),t._v(" "),a("ol",[a("li",[t._v("状态 2(已获取响应头) 和状态 3(正在下载响应体)\n说明响应并不是一次性返回的，响应是分步返回的，当响应体很大时，是可以分次返回的。")]),t._v(" "),a("li",[t._v("获取到响应状态码 200 只能表示服务器统一这次响应，并不代表请求成功获得响应。")]),t._v(" "),a("li",[t._v("状态 4(请求完成) 表示响应体已经全部下载完成，这是才能确认请求的响应是成功的。")])]),t._v(" "),a("h4",{attrs:{id:"_4-request-onreadystatechange-监听状态改变"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-request-onreadystatechange-监听状态改变"}},[t._v("#")]),t._v(" ④ request.onreadystatechange 监听状态改变")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onreadystatechange")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("readyState "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"请求响应都结束了"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("299")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"请求成功了"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"收到响应的内容："')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("responseText"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("400")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"请求失败了"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br")])]),a("h4",{attrs:{id:"_5-request-setrequestheader-header-value-设置请求头"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-request-setrequestheader-header-value-设置请求头"}},[t._v("#")]),t._v(" ⑤ request.setRequestHeader(header, value)设置请求头")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("请求的第 2 部分 key:value 都有可以通过.setRequestHeader 来设置")])]),t._v(" "),a("li",[a("code",[t._v('request.setRequestHeader("Content-Type"," application/x-www-form-urlencoded");')])]),t._v(" "),a("li",[a("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest/setRequestHeader",target:"_blank",rel:"noopener noreferrer"}},[t._v("XMLHttpRequest.setRequestHeaderd()——MDN"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("设置 HTTP 请求头部的方法。")]),t._v(" "),a("li",[t._v("此方法必须在 open()方法和 send()之间调用。")]),t._v(" "),a("li",[t._v("如果多次对同一个请求头赋值，只会生成一个合并了多个值的请求头。")]),t._v(" "),a("li",[t._v("注意：")]),t._v(" "),a("li",[t._v('自定义一些 header 属性进行跨域请求时，可能会遇到不允许跨域请求，需要在服务端设置"Access-Control-Allow-Headers"。')])]),t._v(" "),a("h4",{attrs:{id:"_6-request-send-body-设置请求体并将请求发送到服务器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-request-send-body-设置请求体并将请求发送到服务器"}},[t._v("#")]),t._v(" ⑥ request.send(body) 设置请求体并将请求发送到服务器")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("用于设置 POST 请求的第 4 部分")])]),t._v(" "),a("li",[a("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/send",target:"_blank",rel:"noopener noreferrer"}},[t._v("XMLHttpRequest.send()——MDN"),a("OutboundLink")],1)])]),t._v(" "),a("blockquote",[a("p",[t._v("The XMLHttpRequest method send() sends the request to the server.\nIf the request is asynchronous (which is the default), this method returns as soon as the request is sent and the result is delivered using events. If the request is synchronous, this method doesn't return until the response has arrived.")])]),t._v(" "),a("ul",[a("li",[a("code",[t._v("request.send()")]),t._v(" 的返回值(ReturnValue) 是 "),a("code",[t._v("undefined")]),t._v("。")]),t._v(" "),a("li",[t._v("如果请求是异步的（默认），则此方法将在 请求被发送 且 使用事件传递结果 时返回。")]),t._v(" "),a("li",[t._v("如果请求是同步的，则该方法在响应到达后返回。")])]),t._v(" "),a("h4",{attrs:{id:"_7-获取响应内容"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-获取响应内容"}},[t._v("#")]),t._v(" ⑦ 获取响应内容")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("request.status")]),t._v(" //响应的状态码 200")]),t._v(" "),a("li",[a("code",[t._v("request.statusText")]),t._v(" // 响应状态解释 OK")]),t._v(" "),a("li",[a("code",[t._v("request.getAllResponseHeaders()")]),t._v(" 获取响应头\n"),a("code",[t._v("console.log(request.getAllResponseHeaders())")])]),t._v(" "),a("li",[a("code",[t._v('request.getAllResponseHeaders("Content-Type")')]),t._v(" //获取响应头中的 Content-Type")]),t._v(" "),a("li",[a("code",[t._v("request.responseText")]),t._v(" // 获取响应的内容\n"),a("code",[t._v("const repText = request.responseText")])])]),t._v(" "),a("h4",{attrs:{id:"_8-总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-总结"}},[t._v("#")]),t._v(" ⑧ 总结：")]),t._v(" "),a("p",[a("strong",[t._v("通过 AJAX 可以设置请求的 4 个部分，也可以获取响应的 4 个部分")])]),t._v(" "),a("ol",[a("li",[a("p",[t._v("JS 可以设置任意请求 header 吗\n第一部分 request.open('get', '/xxx')\n第二部分 request.setRequestHeader('content-type','x-www-form-urlencoded')\n第四部分 request.send('a=1&b=2')")])]),t._v(" "),a("li",[a("p",[t._v("JS 可以获取任意响应 header 吗？\n第一部分 request.status / request.statusText\n第二部分 request.getResponseHeader() / request.getAllResponseHeaders()\n第四部分 request.responseText")])])]),t._v(" "),a("h2",{attrs:{id:"_3-json"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-json"}},[t._v("#")]),t._v(" 3.JSON")]),t._v(" "),a("p",[t._v("由于最初发明 AJAX 时只有 XML，HTML 尚未发明，所以服务器必须返回 XML 格式的字符串。\n但是无论是 XML 还是 HTML，都是 DOM 文档，需要后续处理取出 DOM，很麻烦。\n如果有一种更加简便的方式去传递数据就更好了！\n于是 JSON 语言被发明。")]),t._v(" "),a("h3",{attrs:{id:"json-的发明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#json-的发明"}},[t._v("#")]),t._v(" JSON 的发明")]),t._v(" "),a("ul",[a("li",[t._v("JSON：JavaScript Object Notation, JS 对象简谱，是一种轻量级的数据交换格式。")]),t._v(" "),a("li",[t._v("它基于 ECMAScript 的一个子集，采用完全独立于编程语言的文本格式来存储和表示数据。")]),t._v(" "),a("li",[t._v("发明人：Douglas Crockford (道格拉斯 克罗克福德)")]),t._v(" "),a("li",[t._v("优点：易于人阅读和编写，同时也易于机器解析和生成，并有效地提升网络传输效率。")])]),t._v(" "),a("h3",{attrs:{id:"json-语法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#json-语法"}},[t._v("#")]),t._v(" JSON 语法")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"http://www.json.org.cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("JSON 中文官方文档"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.json.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("JSON 英文官方文档"),a("OutboundLink")],1)])]),t._v(" "),a("p",[t._v("总结：")]),t._v(" "),a("ol",[a("li",[t._v("JSON 没有抄袭 JS 中的 function 和 undefined")]),t._v(" "),a("li",[t._v('JSON 的字符串首尾必须是双引号"')]),t._v(" "),a("li",[t._v("比较：")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[t._v("比较")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("JS")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("JSON")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("字符串")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("'yexy'")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v('"yexy"')])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("未定义")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("undefined")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("没有")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("空")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("null")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("null")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("数组")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("['a','b']")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v('["a","b"]')])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("对象")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v('{name:"yexy"}')]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v('{"name":"yexy"}')])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("函数")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("function(){}")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("没有")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("声明")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("var a = {}")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("JSON 没有变量")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("原型链")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("__ proto __")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("JSON 没有原型链")])])])]),t._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[t._v("JSON 不是编程语言，JSON 是数据格式化语言")]),t._v(" "),a("li",[t._v("JSON 不能表示复杂对象，只能表示哈希")])]),t._v(" "),a("h3",{attrs:{id:"json-使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#json-使用"}},[t._v("#")]),t._v(" JSON 使用")]),t._v(" "),a("ul",[a("li",[t._v("服务端设置响应文本类型")]),t._v(" "),a("li",[a("code",[t._v("response.setHeader ('Content-Type' , 'text/json ; charset = utf-8')")])]),t._v(" "),a("li",[t._v("用 JSON 文本替换 XML 文本")])]),t._v(" "),a("div",{staticClass:"language-ts line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// XML文本")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("node"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("to"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("Linzhihui"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("to"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("yexy"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("heading"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("打招呼"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("heading"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("content"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("哈哈哈哈"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("content"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("node"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// JSON格式文本")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"node"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"to"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Linzhihui"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"from"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"yexy"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"heading"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"打招呼"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"content"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"哈哈哈哈"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br")])]),a("p",[t._v("使用 JSON 语法传输数据")]),t._v(" "),a("div",{staticClass:"language-ts line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[t._v("response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"node":{"to":"Linzhihui","from":"yexy","heading":"打招呼","content":"哈哈哈哈"}}\'')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 注意，响应返回的是字符串，不是对象")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("h3",{attrs:{id:"json-相关-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#json-相关-api"}},[t._v("#")]),t._v(" JSON 相关 API")]),t._v(" "),a("h4",{attrs:{id:"处理服务器响应的-json-字符串"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#处理服务器响应的-json-字符串"}},[t._v("#")]),t._v(" 处理服务器响应的 json 字符串")]),t._v(" "),a("p",[t._v("把符合 JSON 语法的字符串转换成 JS 对象 "),a("code",[t._v("window.JSON.parse( )")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" resText "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("responseText"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" resObj "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("resText"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("resObj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[t._v("一般不会直接用，避免后端传送过来的 JSON 数据有错，浏览器报错强制暂停。\n处理方法：")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  obj "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"errors\'a"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// 当被解析的"errors\'a"是错误的JSON格式时')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  obj "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" errors"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 手动将obj.errors替换成错误码")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("errors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br")])]),a("ul",[a("li",[t._v("在后端设置响应头"),a("code",[t._v('response.setHeader("Content-Type","application/json"),charset=utf-8')])]),t._v(" "),a("li",[t._v("jQuery 有内置 API 可以通过"),a("code",[t._v("const resText = request.responseJSON")]),t._v("，直接将 json 翻译成对象")])]),t._v(" "),a("h4",{attrs:{id:"js-对象-与-json-字符串-相互转化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#js-对象-与-json-字符串-相互转化"}},[t._v("#")]),t._v(" JS 对象 与 JSON 字符串 相互转化")]),t._v(" "),a("h5",{attrs:{id:"json-字符串-js-对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#json-字符串-js-对象"}},[t._v("#")]),t._v(" JSON 字符串——>JS 对象")]),t._v(" "),a("ol",[a("li",[t._v("使用 jQuery，在 ajax 函数中参数"),a("code",[t._v("Datatype")]),t._v("传 json 即可，返回的 data 即为 JSON 对象")])]),t._v(" "),a("ul",[a("li",[t._v("对表单处理为 json 字符串，可以使用"),a("code",[t._v(".serialize()")]),t._v("与"),a("code",[t._v(".serializeArray()")]),t._v("处理")]),t._v(" "),a("li",[t._v("要作为 URL 调用，则可以使用"),a("code",[t._v("jQuery.param()")]),t._v("处理")])]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[a("code",[t._v("$.parseJSON( jsonstr)")])]),t._v(" "),a("li",[t._v("浏览器自带 "),a("code",[t._v("JSON.parse(jsonstr)")]),t._v("(推荐)")]),t._v(" "),a("li",[t._v("使用字符串转代码功能 "),a("code",[t._v("eval('(' + jsonstr + ')');")]),t._v("(不推荐)")]),t._v(" "),a("li",[t._v("使用 json 官方的 json.js 调用"),a("code",[t._v("parse()")]),t._v("方法")])]),t._v(" "),a("h5",{attrs:{id:"js-对象-json-字符串"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#js-对象-json-字符串"}},[t._v("#")]),t._v(" JS 对象——>JSON 字符串")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("JSON.stringify(jsonobj)")]),t._v("(推荐)")]),t._v(" "),a("li",[a("code",[t._v("obj.toJSONString()")])])]),t._v(" "),a("h2",{attrs:{id:"_4-跨域问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-跨域问题"}},[t._v("#")]),t._v(" 4.跨域问题")]),t._v(" "),a("h3",{attrs:{id:"ajax-不能跨域请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ajax-不能跨域请求"}},[t._v("#")]),t._v(" AJAX 不能跨域请求")]),t._v(" "),a("p",[t._v("为什么 form 表单提交没有跨域问题，但是 AJAX 提交有跨域问题?")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://www.zhihu.com/question/31592553/answer/190789780",target:"_blank",rel:"noopener noreferrer"}},[t._v("知乎答案——方应杭"),a("OutboundLink")],1)]),t._v(" "),a("blockquote",[a("p",[t._v("因为原页面用 form 提交到另一个域名之后，原页面的脚本无法获取新页面中的内容。所以浏览器认为这是安全的。\n而 AJAX 是可以读取响应内容的，因此浏览器不能允许你这样做。其实请求已经发送出去了，你只是拿不到响应而已。\n浏览器这个策略的本质是，一个域名的 JS ，在未经允许的情况下，不得读取另一个域名的内容。\n但浏览器并不阻止你向另一个域名发送请求。")])]),t._v(" "),a("ul",[a("li",[t._v("也就是说：如果你不是 baidu.com 的 JS 就不能向 baidu.com 发起 AJAX 请求。")]),t._v(" "),a("li",[t._v("只有协议、域名、端口 一模一样才可以发起 AJAX 请求。")])]),t._v(" "),a("h3",{attrs:{id:"同源策略"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#同源策略"}},[t._v("#")]),t._v(" 同源策略")]),t._v(" "),a("p",[a("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2016/04/same-origin-policy.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("浏览器同源政策及其规避方法 —— 阮一峰"),a("OutboundLink")],1)]),t._v(" "),a("ol",[a("li",[t._v('所谓"同源"指的是"三个相同"：\n'),a("blockquote",[a("p",[t._v("协议相同\n域名相同\n端口相同")])])]),t._v(" "),a("li",[t._v("如果非同源，共有三种行为受到限制：\n"),a("blockquote",[a("p",[t._v("Cookie、LocalStorage 和 IndexDB 无法读取。\nDOM 无法获得。\nAJAX 请求不能发送。")])])])]),t._v(" "),a("h3",{attrs:{id:"让-ajax-可以跨域请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#让-ajax-可以跨域请求"}},[t._v("#")]),t._v(" 让 AJAX 可以跨域请求")]),t._v(" "),a("ul",[a("li",[t._v("与目标请求域名的后端沟通，开放来自"),a("code",[t._v("http://yexy.com:8001")]),t._v("AJAX 请求的权限。")]),t._v(" "),a("li",[a("code",[t._v("response.setHeader ('Access-Control-Allow-Origin' , 'http://yexy.com:8001')")])]),t._v(" "),a("li",[t._v("这项技术叫 CORS 跨源资源共享")]),t._v(" "),a("li",[t._v("全称：cross-origin sharing standard")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS",target:"_blank",rel:"noopener noreferrer"}},[t._v("跨源资源共享（CORS）——MDN"),a("OutboundLink")],1)])]),t._v(" "),a("h3",{attrs:{id:"ajax-与-jsonp-比较"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ajax-与-jsonp-比较"}},[t._v("#")]),t._v(" AJAX 与 JSONP 比较")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[t._v("AJAX")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("JSONP")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("可以发送任意请求")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("只能 GET，不能 POST")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("不能跨域请求，需与 CORS 技术配合")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("可以跨域请求")])])])]),t._v(" "),a("h2",{attrs:{id:"_5-promise"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-promise"}},[t._v("#")]),t._v(" 5.Promise")]),t._v(" "),a("ul",[a("li",[t._v("Promise 只是一种确定函数形式的规范")]),t._v(" "),a("li",[t._v("面对不同的服务器后端，")]),t._v(" "),a("li",[t._v("对于请求成功和失败的响应的函数命名不一样")]),t._v(" "),a("li",[t._v("成功可能是 success/onload 等")]),t._v(" "),a("li",[t._v("失败可能是 fail/error 等")])]),t._v(" "),a("h3",{attrs:{id:"jquery-的-promise"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jquery-的-promise"}},[t._v("#")]),t._v(" jQuery 的 Promise")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ajax")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  url"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/xxx"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  method"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"get"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  key"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("success"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" fail"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("ol",[a("li",[t._v("成功函数和失败函数可以不具名：")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ajax")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[t._v("这是 jQuery 的 promise")]),t._v(" "),a("li",[t._v("可以多个.then()链式操作下去，实现对同一个状态进行多次处理")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ajax")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1111")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 成功函数，接收.ajax()的返回值")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2222")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 失败函数，接收.ajax()的返回值")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1111")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2222")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 成功函数，接收上一个.then()成功/失败函数的返回值(无论成功还是失败了，只要上一个.then成功执行了就是成功)")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 失败函数，上一个.then()失败了执行")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br")])]),a("h3",{attrs:{id:"自己封装实现-promise"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自己封装实现-promise"}},[t._v("#")]),t._v(" 自己封装实现 Promise")]),t._v(" "),a("ul",[a("li",[t._v("jQuery 的.ajax()是有返回值的")]),t._v(" "),a("li",[t._v("我们自己写得 ajax 没有返回值，因此要手动设置返回值")])]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("window.jQuery.ajax = function (arr) {return new Promise(function (resolve, reject) {})}\nconst promise = window.jQuery.ajax()\npromise.then(fn1,fn2)\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jQuery"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("ajax")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" method"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" headers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" body "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Promise")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resolve"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" reject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" request "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("XMLHttpRequest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("method"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" key "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" headers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setRequestHeader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" headers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onreadystatechange")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("readyState "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("299")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("call")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("400")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("call")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nwindow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jQuery"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nyexy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("button"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"click"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ajax")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    method"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"POST"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    url"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/yyyexy"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    headers"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Content-Type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"application/x-www-form-urlencoded"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    body"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a=1&b=2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("request")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"请求成功了"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAllResponseHeaders")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("request")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"请求失败了"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br"),a("span",{staticClass:"line-number"},[t._v("31")]),a("br"),a("span",{staticClass:"line-number"},[t._v("32")]),a("br"),a("span",{staticClass:"line-number"},[t._v("33")]),a("br"),a("span",{staticClass:"line-number"},[t._v("34")]),a("br"),a("span",{staticClass:"line-number"},[t._v("35")]),a("br"),a("span",{staticClass:"line-number"},[t._v("36")]),a("br"),a("span",{staticClass:"line-number"},[t._v("37")]),a("br"),a("span",{staticClass:"line-number"},[t._v("38")]),a("br"),a("span",{staticClass:"line-number"},[t._v("39")]),a("br")])]),a("hr"),t._v(" "),a("p",[a("em",[t._v("Copyright © 2020 - 2021 by 叶旭瑶 . All Rights Reserved .")])])])}),[],!1,null,null,null);s.default=e.exports}}]);