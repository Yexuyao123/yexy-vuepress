(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{368:function(t,a,s){"use strict";s.r(a);var r=s(42),v=Object(r.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"_03-前端性能优化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_03-前端性能优化"}},[t._v("#")]),t._v(" [03] 前端性能优化")]),t._v(" "),s("p",[s("em",[t._v("2021 年 4 月 15 日")])]),t._v(" "),s("hr"),t._v(" "),s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#_03-前端性能优化"}},[t._v("[03] 前端性能优化")])]),s("li",[s("a",{attrs:{href:"#常见的优化"}},[t._v("常见的优化")])]),s("li",[s("a",{attrs:{href:"#案例"}},[t._v("案例")]),s("ul",[s("li",[s("a",{attrs:{href:"#常见优化方案"}},[t._v("常见优化方案")]),s("ul",[s("li",[s("a",{attrs:{href:"#css-的-layout-优化"}},[t._v("css 的 layout 优化")])]),s("li",[s("a",{attrs:{href:"#react-的组件优化"}},[t._v("react 的组件优化")])]),s("li",[s("a",{attrs:{href:"#提升了首屏性能"}},[t._v("提升了首屏性能")])])])]),s("li",[s("a",{attrs:{href:"#请求防抖"}},[t._v("请求防抖")])]),s("li",[s("a",{attrs:{href:"#如何通过预加载器提升网页加载速度"}},[t._v("如何通过预加载器提升网页加载速度")]),s("ul",[s("li",[s("a",{attrs:{href:"#浏览器是如何加载网页"}},[t._v("浏览器是如何加载网页")])]),s("li",[s("a",{attrs:{href:"#预加载器如何提高网络利用率"}},[t._v("预加载器如何提高网络利用率")])]),s("li",[s("a",{attrs:{href:"#各大厂对预加载器的应用"}},[t._v("各大厂对预加载器的应用")])]),s("li",[s("a",{attrs:{href:"#预加载器的陷阱"}},[t._v("预加载器的陷阱")])]),s("li",[s("a",{attrs:{href:"#影响预加载器的加载顺序的因素"}},[t._v("影响预加载器的加载顺序的因素")])]),s("li",[s("a",{attrs:{href:"#预加载-vs-预读取"}},[t._v("预加载 VS 预读取")]),s("ul",[s("li",[s("a",{attrs:{href:"#预读取-pre-fetching"}},[t._v("预读取（Pre-fetching）")])]),s("li",[s("a",{attrs:{href:"#预读取"}},[t._v("预读取")])])])])])]),s("li",[s("a",{attrs:{href:"#其他"}},[t._v("其他")])])])]),s("li",[s("a",{attrs:{href:"#"}})])])]),s("p"),t._v(" "),s("h1",{attrs:{id:"常见的优化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常见的优化"}},[t._v("#")]),t._v(" 常见的优化")]),t._v(" "),s("ul",[s("li",[t._v("使用虚拟列表")]),t._v(" "),s("li",[t._v("基于 Service worker/web worker 的 cache")]),t._v(" "),s("li",[t._v("使用 CSS 动画")]),t._v(" "),s("li",[t._v("图片压缩")]),t._v(" "),s("li",[t._v("Gzip 压缩")]),t._v(" "),s("li",[s("strong",[t._v("域名预解析")])])]),t._v(" "),s("div",{staticClass:"language-html line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("link")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("rel")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("dns-prefetch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("//g.alicdn.com"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h1",{attrs:{id:"案例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#案例"}},[t._v("#")]),t._v(" 案例")]),t._v(" "),s("h2",{attrs:{id:"常见优化方案"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常见优化方案"}},[t._v("#")]),t._v(" 常见优化方案")]),t._v(" "),s("h3",{attrs:{id:"css-的-layout-优化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#css-的-layout-优化"}},[t._v("#")]),t._v(" css 的 layout 优化")]),t._v(" "),s("ul",[s("li",[t._v("CSS 容器属性（contain 及其子元素不影响父元素，建立边界，使得局部变化只引起局部重新渲染）(O 网页链接)")])]),t._v(" "),s("h3",{attrs:{id:"react-的组件优化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#react-的组件优化"}},[t._v("#")]),t._v(" react 的组件优化")]),t._v(" "),s("ul",[s("li",[t._v("减少组件重复/不必要的渲染{Memo(O 网页链接)、避免 inline-function、避免直接传入对象或数组}")]),t._v(" "),s("li",[t._v("减少组件的层级、减少不必要的包装")])]),t._v(" "),s("h3",{attrs:{id:"提升了首屏性能"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#提升了首屏性能"}},[t._v("#")]),t._v(" 提升了首屏性能")]),t._v(" "),s("ul",[s("li",[t._v("首屏渲染优化问题："),s("strong",[t._v("非首屏渲染需要的模块加载抢占了 JS 主线程")])]),t._v(" "),s("li",[t._v("解决方案：")]),t._v(" "),s("li",[t._v("只加载当前需要的资源（"),s("strong",[t._v("延迟加载或懒加载，模块加载和请求资源")]),t._v("）")]),t._v(" "),s("li",[t._v("使得页面的"),s("strong",[t._v("主要部分先渲染完成")]),t._v("再加载 meeting-parser、phone-parser 和其他非首屏必要模块")])]),t._v(" "),s("h2",{attrs:{id:"请求防抖"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#请求防抖"}},[t._v("#")]),t._v(" 请求防抖")]),t._v(" "),s("ul",[s("li",[t._v("见"),s("RouterLink",{attrs:{to:"/我的学习笔记/06-Vue全家桶精进之路/[16]axios进阶：Cancellation实现在切换页面前取消请求.html"}},[t._v("[16]axios 进阶：Cancellation 实现在切换页面前取消请求")])],1)]),t._v(" "),s("h2",{attrs:{id:"如何通过预加载器提升网页加载速度"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#如何通过预加载器提升网页加载速度"}},[t._v("#")]),t._v(" 如何通过预加载器提升网页加载速度")]),t._v(" "),s("ul",[s("li",[t._v("预加载器(Pre-loader)可以说是"),s("strong",[t._v("提高浏览器性能")]),t._v("最重要的举措。")]),t._v(" "),s("li",[t._v("Mozilla 官方发布数据，通过预加载器技术网页的加载性能提升了 19%，Chrome 测试了 Alexa 排名前 2000 名网站，性能有 20%的提升。")]),t._v(" "),s("li",[s("strong",[t._v("什么是预加载器？它是如何提升浏览器性能的？")])])]),t._v(" "),s("h3",{attrs:{id:"浏览器是如何加载网页"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#浏览器是如何加载网页"}},[t._v("#")]),t._v(" 浏览器是如何加载网页")]),t._v(" "),s("ul",[s("li",[t._v("一个网页的加载依赖于脚本文件、CSS 样式文件。")]),t._v(" "),s("li",[t._v("首先，"),s("strong",[t._v("浏览器下载 HTML 并开始解析")]),t._v("。如果浏览器"),s("strong",[t._v("发现外部 CSS 资源链接则发送下载请求")]),t._v("。")]),t._v(" "),s("li",[t._v("浏览器可以在"),s("strong",[t._v("下载 CSS 资源的同时，并行解析 HTML 文件")]),t._v("，")]),t._v(" "),s("li",[t._v("但是，一旦"),s("strong",[t._v("发现有脚本文件的引用，则必须等待脚本文件完成下载并且执行后才能继续解析。")])]),t._v(" "),s("li",[t._v("脚本文件完成下载并且执行后，浏览器可以继续解析 HTML 工作，")]),t._v(" "),s("li",[t._v("如果"),s("strong",[t._v("遇到")]),t._v("非阻塞资源，例如"),s("strong",[t._v("图片")]),t._v("，浏览器会"),s("strong",[t._v("发送下载请求并且继续解析")]),t._v("。")]),t._v(" "),s("li",[t._v("即使浏览器"),s("strong",[t._v("可以并行执行多个请求")]),t._v("，但是"),s("strong",[t._v("无法与针对脚本文件的操作并行执行")]),t._v("。")]),t._v(" "),s("li",[t._v("通过 IE7 打开链接中的网页进行测试可以看到：")]),t._v(" "),s("li",[t._v("网页 head 标签内包含 2 个样式文件和 2 个脚本文件。在 body 中，包含 3 个图片、1 个脚本文件。")]),t._v(" "),s("li",[s("strong",[t._v("脚本文件的下载和执行，会阻断其他资源文件的下载，无疑将大大降低浏览器性能")]),t._v("。")])]),t._v(" "),s("h3",{attrs:{id:"预加载器如何提高网络利用率"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#预加载器如何提高网络利用率"}},[t._v("#")]),t._v(" 预加载器如何提高网络利用率")]),t._v(" "),s("ul",[s("li",[t._v("2008 年，IE、WebKit 和 Mozilla 都实现了"),s("strong",[t._v("预加载器功能")]),t._v("，来提升网络的利用率，"),s("strong",[t._v("改善脚本文件对其他资源文件的阻塞现状")]),t._v("。")]),t._v(" "),s("li",[t._v("当浏览器被脚本文件阻塞时，另一个"),s("strong",[t._v("轻量级的解析器")]),t._v("会"),s("strong",[t._v("继续浏览剩余的标记")]),t._v("，"),s("strong",[t._v("寻找需要下载的资源样式文件，脚本文件，图片")]),t._v("等。")]),t._v(" "),s("li",[t._v("一旦发现，"),s("strong",[t._v("预加载器既可以在后台开始接收这些资源，等待主解析器完成当前的脚本操作")])]),t._v(" "),s("li",[t._v("等到著解析器完成解析脚本工作时其他资源已经完成下载，这样就减轻了脚本阻塞带来的性能损耗。")]),t._v(" "),s("li",[t._v("以瀑布流为例，使用 IE8 打开链接中网页的结果，可以看到性能有显著的提升。")])]),t._v(" "),s("h3",{attrs:{id:"各大厂对预加载器的应用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#各大厂对预加载器的应用"}},[t._v("#")]),t._v(" 各大厂对预加载器的应用")]),t._v(" "),s("ul",[s("li",[t._v("预加载功能是各大浏览器厂商乐此不疲的实验领域。")]),t._v(" "),s("li",[t._v("很多"),s("strong",[t._v("浏览器尝试设置资源下载的优先级")]),t._v("。")]),t._v(" "),s("li",[t._v("例如：")]),t._v(" "),s("li",[s("strong",[t._v("Safari")]),t._v("降低了不作用于当前视图区域样式文件的优先级。")]),t._v(" "),s("li",[s("strong",[t._v("Chrome")]),t._v("则设置脚本文件的优先级高于图片，即使脚本文件位于 HTML 底部。")])]),t._v(" "),s("h3",{attrs:{id:"预加载器的陷阱"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#预加载器的陷阱"}},[t._v("#")]),t._v(" 预加载器的陷阱")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("预加载器只能检索 HTML 标签中的 URL")]),t._v("，"),s("strong",[t._v("无法检测到使用脚本代码添加的 URL")]),t._v("，直至脚本代码执行时才可以获取这类资源。")]),t._v(" "),s("li",[t._v("经典的例子：")]),t._v(" "),s("li",[t._v("通过 javascript 判断当前 Window 宽度，进而决策加载 CSS 样式文件的例子。预加载器无法识别此类资源。")])]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("script"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" varfile "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerWidth "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mobile.css"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"desktop.css"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'href=\"……\"'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("ul",[s("li",[t._v("上面这段代码可以轻松的骗过 IE9 的预加载机制，")]),t._v(" "),s("li",[t._v("在瀑布流案例中可以看到，"),s("strong",[t._v("加载图片占用了所有的连接，直至第一个图片加载完成后，CSS 文件才开始下载")]),t._v("。")])]),t._v(" "),s("h3",{attrs:{id:"影响预加载器的加载顺序的因素"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#影响预加载器的加载顺序的因素"}},[t._v("#")]),t._v(" 影响预加载器的加载顺序的因素")]),t._v(" "),s("ul",[s("li",[t._v("当前有几种方式来控制预加载器的加载顺序（使用 javacript 隐藏资源文件既是其中一种），")]),t._v(" "),s("li",[t._v("同时，"),s("strong",[t._v("W3C")]),t._v("ResourcePriorities 中也提供两个"),s("strong",[t._v("特性")]),t._v("来"),s("strong",[t._v("影响预加载器")]),t._v("。")]),t._v(" "),s("li",[s("strong",[t._v("lazyload")]),t._v(":直至没有被标记为 lazyload 资源下载完毕后才下载被标记资源。")]),t._v(" "),s("li",[s("strong",[t._v("postpone")]),t._v(":资源在对最终用户可见之后才开始下载。i.e.标签的 display 属性被设置为 none。")])]),t._v(" "),s("h3",{attrs:{id:"预加载-vs-预读取"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#预加载-vs-预读取"}},[t._v("#")]),t._v(" 预加载 VS 预读取")]),t._v(" "),s("h4",{attrs:{id:"预读取-pre-fetching"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#预读取-pre-fetching"}},[t._v("#")]),t._v(" 预读取（Pre-fetching）")]),t._v(" "),s("ul",[s("li",[t._v("可以通知浏览器哪些资源可能会在未来的某一时机，在当前页面或者其他页面中使用。")]),t._v(" "),s("li",[t._v("预读取的一个简单的应用：通知浏览器为将要访问的其他站点加载资源：")])]),t._v(" "),s("ol",[s("li",[t._v("声明优先高级别")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("Chrome 允许我们预先通知浏览器加载未来会用到的资源")]),t._v("，")]),t._v(" "),s("li",[s("strong",[t._v("被声明的资源将以较高的优先级被下载")]),t._v("(Chromium 源码中提到，被标记为"),s("strong",[t._v("subresource")]),t._v("的资源下载的"),s("strong",[t._v("优先级低")]),t._v("于样式文件和脚本文件，但不低于图片加载优先级）")])]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[t._v("标记低级别")])]),t._v(" "),s("ul",[s("li",[t._v("还有标记可以通知浏览器哪些文件是较低级别的预读取文件。")])]),t._v(" "),s("h4",{attrs:{id:"预读取"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#预读取"}},[t._v("#")]),t._v(" 预读取")]),t._v(" "),s("ul",[s("li",[t._v("预读取"),s("strong",[t._v("未来将被使用的独立资源文件")]),t._v("。")]),t._v(" "),s("li",[t._v("通过预读取方式，"),s("strong",[t._v("在后台渲染整个页面")]),t._v("。")])]),t._v(" "),s("h2",{attrs:{id:"其他"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#其他"}},[t._v("#")]),t._v(" 其他")]),t._v(" "),s("ul",[s("li",[t._v("考虑 cpu 的消耗，内存的优化，")]),t._v(" "),s("li",[t._v("在数据监控方面，通过埋点、long task 等指标更全面的监控数据的变化。")]),t._v(" "),s("li",[s("a",{attrs:{href:"https://mp.weixin.qq.com/s/J60NkG8A_E-vI3RpKQSTmw",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考——前端性能优化"),s("OutboundLink")],1)])]),t._v(" "),s("h1",{attrs:{id:""}},[s("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")])]),t._v(" "),s("hr"),t._v(" "),s("p",[s("em",[t._v("Copyright © 2020 - 2021 by 叶旭瑶 . All Rights Reserved .")])])])}),[],!1,null,null,null);a.default=v.exports}}]);