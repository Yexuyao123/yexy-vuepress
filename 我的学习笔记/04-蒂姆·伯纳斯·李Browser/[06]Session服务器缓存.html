<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>[06] Session / 服务器缓存 | 叶旭瑶</title>
    <meta name="generator" content="VuePress 1.8.0">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.2e040761.css" as="style"><link rel="preload" href="/assets/js/app.a8df1c95.js" as="script"><link rel="preload" href="/assets/js/2.48d09664.js" as="script"><link rel="preload" href="/assets/js/40.c28128a5.js" as="script"><link rel="prefetch" href="/assets/js/10.90ae3223.js"><link rel="prefetch" href="/assets/js/11.60747cf8.js"><link rel="prefetch" href="/assets/js/12.78613ebb.js"><link rel="prefetch" href="/assets/js/13.15cefad8.js"><link rel="prefetch" href="/assets/js/14.2706d9af.js"><link rel="prefetch" href="/assets/js/15.4a1534b3.js"><link rel="prefetch" href="/assets/js/16.667b9eec.js"><link rel="prefetch" href="/assets/js/17.2f6f2fb7.js"><link rel="prefetch" href="/assets/js/18.ae0db680.js"><link rel="prefetch" href="/assets/js/19.3a1a9b2b.js"><link rel="prefetch" href="/assets/js/20.b37fd568.js"><link rel="prefetch" href="/assets/js/21.00e571a2.js"><link rel="prefetch" href="/assets/js/22.7113929a.js"><link rel="prefetch" href="/assets/js/23.76749a7b.js"><link rel="prefetch" href="/assets/js/24.d64a7195.js"><link rel="prefetch" href="/assets/js/25.dd0efafa.js"><link rel="prefetch" href="/assets/js/26.b526a833.js"><link rel="prefetch" href="/assets/js/27.0d7e1a2b.js"><link rel="prefetch" href="/assets/js/28.ff5daa9c.js"><link rel="prefetch" href="/assets/js/29.6b832bc1.js"><link rel="prefetch" href="/assets/js/3.dc0eeb90.js"><link rel="prefetch" href="/assets/js/30.9473db5d.js"><link rel="prefetch" href="/assets/js/31.32df4c34.js"><link rel="prefetch" href="/assets/js/32.e34273e7.js"><link rel="prefetch" href="/assets/js/33.4d28e2f8.js"><link rel="prefetch" href="/assets/js/34.e19c3a87.js"><link rel="prefetch" href="/assets/js/35.ae6f54a4.js"><link rel="prefetch" href="/assets/js/36.c311869c.js"><link rel="prefetch" href="/assets/js/37.fe07ec53.js"><link rel="prefetch" href="/assets/js/38.b9b76405.js"><link rel="prefetch" href="/assets/js/39.ce5b3eb6.js"><link rel="prefetch" href="/assets/js/4.52766d3a.js"><link rel="prefetch" href="/assets/js/41.baa5b9df.js"><link rel="prefetch" href="/assets/js/42.e9dd8626.js"><link rel="prefetch" href="/assets/js/43.1870fb99.js"><link rel="prefetch" href="/assets/js/44.5f5cadd9.js"><link rel="prefetch" href="/assets/js/45.6e86d635.js"><link rel="prefetch" href="/assets/js/46.6f9e3d5c.js"><link rel="prefetch" href="/assets/js/47.da89bc26.js"><link rel="prefetch" href="/assets/js/48.29abeeb3.js"><link rel="prefetch" href="/assets/js/49.82a3a29d.js"><link rel="prefetch" href="/assets/js/5.9eccb937.js"><link rel="prefetch" href="/assets/js/50.b2028d20.js"><link rel="prefetch" href="/assets/js/51.9208c15a.js"><link rel="prefetch" href="/assets/js/52.db1c8ad3.js"><link rel="prefetch" href="/assets/js/53.2c6c7978.js"><link rel="prefetch" href="/assets/js/54.4a5fc56a.js"><link rel="prefetch" href="/assets/js/55.43d12619.js"><link rel="prefetch" href="/assets/js/56.f78e78dd.js"><link rel="prefetch" href="/assets/js/57.b92e209e.js"><link rel="prefetch" href="/assets/js/58.6b552921.js"><link rel="prefetch" href="/assets/js/59.90266c96.js"><link rel="prefetch" href="/assets/js/6.710abc21.js"><link rel="prefetch" href="/assets/js/60.fb66ef65.js"><link rel="prefetch" href="/assets/js/61.82cc26c2.js"><link rel="prefetch" href="/assets/js/62.a0a80205.js"><link rel="prefetch" href="/assets/js/63.dda7942d.js"><link rel="prefetch" href="/assets/js/64.0a5e6f5b.js"><link rel="prefetch" href="/assets/js/65.fb8144ce.js"><link rel="prefetch" href="/assets/js/66.8a1226d0.js"><link rel="prefetch" href="/assets/js/67.5b575b21.js"><link rel="prefetch" href="/assets/js/68.f3b6f395.js"><link rel="prefetch" href="/assets/js/69.2c6ce239.js"><link rel="prefetch" href="/assets/js/7.d448298b.js"><link rel="prefetch" href="/assets/js/70.142aeb69.js"><link rel="prefetch" href="/assets/js/71.a3a3c331.js"><link rel="prefetch" href="/assets/js/72.c2f1a26e.js"><link rel="prefetch" href="/assets/js/73.8f72ade2.js"><link rel="prefetch" href="/assets/js/74.69faefcd.js"><link rel="prefetch" href="/assets/js/75.bf491959.js"><link rel="prefetch" href="/assets/js/76.54b30f01.js"><link rel="prefetch" href="/assets/js/77.9b2b976c.js"><link rel="prefetch" href="/assets/js/78.19096d31.js"><link rel="prefetch" href="/assets/js/79.ae5bc63c.js"><link rel="prefetch" href="/assets/js/8.04185565.js"><link rel="prefetch" href="/assets/js/9.30d66b6d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2e040761.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/hero.jpg" alt="叶旭瑶" class="logo"> <span class="site-name can-hide">叶旭瑶</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="https://baidu.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  导航栏
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="博客" class="dropdown-title"><span class="title">博客</span> <span class="arrow down"></span></button> <button type="button" aria-label="博客" class="mobile-dropdown-title"><span class="title">博客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/我的学习笔记/" class="nav-link">
  博客总览
</a></li><li class="dropdown-item"><!----> <a href="/我的学习笔记/01-Some前端理念/" class="nav-link">
  01-Some前端理念
</a></li><li class="dropdown-item"><!----> <a href="/我的学习笔记/02-CSS美学/" class="nav-link">
  02-CSS美学
</a></li><li class="dropdown-item"><!----> <a href="/我的学习笔记/03-JavaScript永动机/" class="nav-link">
  03-JavaScript永动机
</a></li><li class="dropdown-item"><!----> <a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/" class="nav-link">
  04-蒂姆·伯纳斯·李Browser
</a></li><li class="dropdown-item"><!----> <a href="/我的学习笔记/05-Plugin成就/" class="nav-link">
  05-Plugin成就
</a></li><li class="dropdown-item"><!----> <a href="/我的学习笔记/06-Vue全家桶精进之路/" class="nav-link">
  06-Vue全家桶精进之路
</a></li><li class="dropdown-item"><!----> <a href="/我的学习笔记/07-计算机常识积累/" class="nav-link">
  07-计算机常识积累
</a></li></ul></div></div><div class="nav-item"><a href="https://google.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  谷歌搜索
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="https://baidu.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  导航栏
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="博客" class="dropdown-title"><span class="title">博客</span> <span class="arrow down"></span></button> <button type="button" aria-label="博客" class="mobile-dropdown-title"><span class="title">博客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/我的学习笔记/" class="nav-link">
  博客总览
</a></li><li class="dropdown-item"><!----> <a href="/我的学习笔记/01-Some前端理念/" class="nav-link">
  01-Some前端理念
</a></li><li class="dropdown-item"><!----> <a href="/我的学习笔记/02-CSS美学/" class="nav-link">
  02-CSS美学
</a></li><li class="dropdown-item"><!----> <a href="/我的学习笔记/03-JavaScript永动机/" class="nav-link">
  03-JavaScript永动机
</a></li><li class="dropdown-item"><!----> <a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/" class="nav-link">
  04-蒂姆·伯纳斯·李Browser
</a></li><li class="dropdown-item"><!----> <a href="/我的学习笔记/05-Plugin成就/" class="nav-link">
  05-Plugin成就
</a></li><li class="dropdown-item"><!----> <a href="/我的学习笔记/06-Vue全家桶精进之路/" class="nav-link">
  06-Vue全家桶精进之路
</a></li><li class="dropdown-item"><!----> <a href="/我的学习笔记/07-计算机常识积累/" class="nav-link">
  07-计算机常识积累
</a></li></ul></div></div><div class="nav-item"><a href="https://google.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  谷歌搜索
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/我的学习笔记/01-Some前端理念" class="sidebar-heading clickable"><span>01-Some前端理念</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/我的学习笔记/02-CSS美学" class="sidebar-heading clickable"><span>02-CSS美学</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/我的学习笔记/03-JavaScript永动机" class="sidebar-heading clickable"><span>03-JavaScript永动机</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser" class="sidebar-heading clickable open"><span>04-蒂姆·伯纳斯·李Browser</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/[01]markdown格式整理.html" class="sidebar-link">[01]markdown格式整理</a></li><li><a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/[02]输入URL到页面展示.html" class="sidebar-link">[02]输入URL到页面展示</a></li><li><a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/[03]XMLHttpRequest请求与AJAX封装.html" class="sidebar-link">[03]XMLHttpRequest请求与AJAX封装</a></li><li><a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/[04]请求响应头与JSONP前后端分离.html" class="sidebar-link">[04]请求响应头与JSONP前后端分离</a></li><li><a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/[05]Cookie与浏览器HTTP缓存控制.html" class="sidebar-link">[05]Cookie与浏览器HTTP缓存控制</a></li><li><a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/[06]Session服务器缓存.html" class="active sidebar-link">[06]Session服务器缓存</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/[06]Session服务器缓存.html#session-有两层含义。" class="sidebar-link">Session 有两层含义。</a></li><li class="sidebar-sub-header"><a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/[06]Session服务器缓存.html#cookie-缓存存在问题" class="sidebar-link">Cookie 缓存存在问题</a></li><li class="sidebar-sub-header"><a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/[06]Session服务器缓存.html#session-会话控制-维基百科" class="sidebar-link">Session 会话控制（维基百科）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/[06]Session服务器缓存.html#tcp-会话" class="sidebar-link">TCP 会话</a></li><li class="sidebar-sub-header"><a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/[06]Session服务器缓存.html#http-会话" class="sidebar-link">HTTP 会话</a></li><li class="sidebar-sub-header"><a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/[06]Session服务器缓存.html#服务器端的会话" class="sidebar-link">服务器端的会话</a></li><li class="sidebar-sub-header"><a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/[06]Session服务器缓存.html#客户端的会话" class="sidebar-link">客户端的会话</a></li><li class="sidebar-sub-header"><a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/[06]Session服务器缓存.html#服务器端会话和客户端的协作" class="sidebar-link">服务器端会话和客户端的协作</a></li></ul></li><li class="sidebar-sub-header"><a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/[06]Session服务器缓存.html#session-原理" class="sidebar-link">Session 原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/[06]Session服务器缓存.html#uid-生成算法方案" class="sidebar-link">UID 生成算法方案</a></li><li class="sidebar-sub-header"><a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/[06]Session服务器缓存.html#随机生成-普通查重模式" class="sidebar-link" style="padding-left:3rem;">随机生成-普通查重模式</a></li><li class="sidebar-sub-header"><a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/[06]Session服务器缓存.html#经典表-id-自增" class="sidebar-link" style="padding-left:3rem;">经典表 ID 自增</a></li><li class="sidebar-sub-header"><a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/[06]Session服务器缓存.html#号池模式" class="sidebar-link" style="padding-left:3rem;">号池模式</a></li><li class="sidebar-sub-header"><a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/[06]Session服务器缓存.html#随机生成-查重模式-加位法" class="sidebar-link" style="padding-left:3rem;">随机生成-查重模式-加位法</a></li><li class="sidebar-sub-header"><a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/[06]Session服务器缓存.html#类-snowflake-模式" class="sidebar-link" style="padding-left:3rem;">类 Snowflake 模式</a></li><li class="sidebar-sub-header"><a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/[06]Session服务器缓存.html#uuid-模式" class="sidebar-link" style="padding-left:3rem;">UUID 模式</a></li></ul></li><li class="sidebar-sub-header"><a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/[06]Session服务器缓存.html#cookie-和-session-总结" class="sidebar-link">Cookie 和 Session 总结</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/[06]Session服务器缓存.html#cookie" class="sidebar-link">Cookie</a></li><li class="sidebar-sub-header"><a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/[06]Session服务器缓存.html#session" class="sidebar-link">Session</a></li></ul></li></ul></li><li><a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/[07]LocalStorage与SessionStorage的使用.html" class="sidebar-link">[07]LocalStorage与SessionStorage的使用</a></li><li><a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/[08]JWT实现token验证.html" class="sidebar-link">[08]JWT实现token验证</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/我的学习笔记/05-Plugin成就" class="sidebar-heading clickable"><span>05-Plugin成就</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/我的学习笔记/06-Vue全家桶精进之路" class="sidebar-heading clickable"><span>06-Vue全家桶精进之路</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/我的学习笔记/07-计算机常识积累" class="sidebar-heading clickable"><span>07-计算机常识积累</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_06-session-服务器缓存"><a href="#_06-session-服务器缓存" class="header-anchor">#</a> [06] Session / 服务器缓存</h1> <p><em>2021 年 2 月 1 日</em></p> <hr> <p></p><div class="table-of-contents"><ul><li><a href="#_06-session-服务器缓存">[06] Session / 服务器缓存</a><ul><li><a href="#session-有两层含义。">Session 有两层含义。</a></li><li><a href="#cookie-缓存存在问题">Cookie 缓存存在问题</a></li><li><a href="#session-会话控制-维基百科">Session 会话控制（维基百科）</a><ul><li><a href="#tcp-会话">TCP 会话</a></li><li><a href="#http-会话">HTTP 会话</a></li><li><a href="#服务器端的会话">服务器端的会话</a></li><li><a href="#客户端的会话">客户端的会话</a></li><li><a href="#服务器端会话和客户端的协作">服务器端会话和客户端的协作</a></li></ul></li><li><a href="#session-原理">Session 原理</a><ul><li><a href="#uid-生成算法方案">UID 生成算法方案</a><ul><li><a href="#随机生成-普通查重模式">随机生成-普通查重模式</a></li><li><a href="#经典表-id-自增">经典表 ID 自增</a></li><li><a href="#号池模式">号池模式</a></li><li><a href="#随机生成-查重模式-加位法">随机生成-查重模式-加位法</a></li><li><a href="#类-snowflake-模式">类 Snowflake 模式</a></li><li><a href="#uuid-模式">UUID 模式</a></li></ul></li></ul></li><li><a href="#cookie-和-session-总结">Cookie 和 Session 总结</a><ul><li><a href="#cookie">Cookie</a></li><li><a href="#session">Session</a></li></ul></li></ul></li></ul></div><p></p> <h2 id="session-有两层含义。"><a href="#session-有两层含义。" class="header-anchor">#</a> Session 有两层含义。</h2> <ol><li>服务器端会话和客户端的协作的技术：SessionID 配合 Cookie 使用（见本文）。</li> <li>Session 会话：Session 会话存储——SessionStorage（见 LocalStorage 与 SessionStorage 的使用）。</li></ol> <h2 id="cookie-缓存存在问题"><a href="#cookie-缓存存在问题" class="header-anchor">#</a> Cookie 缓存存在问题</h2> <ul><li>Cookie 缓存属于浏览器缓存，Windows 存在 C 盘分配一个小空间给浏览器储存。</li> <li>浏览器用户通过篡改浏览器 Application—Storage—Cookie 能够获取到其他用户的信息，是不安全的。</li> <li>而使用 Session 和 Cookie 相互配合，可以解决不安全的问题。</li></ul> <h2 id="session-会话控制-维基百科"><a href="#session-会话控制-维基百科" class="header-anchor">#</a> Session 会话控制（维基百科）</h2> <ul><li><a href="https://zh.wikipedia.org/wiki/%E4%BC%9A%E8%AF%9D_(%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6)" target="_blank" rel="noopener noreferrer">Session 维基百科<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>session 是一种持久网络协议，在用户（或用户代理）端和服务器端之间创建关联，从而起到交换数据包的作用机制，session 在网络协议（例如 telnet 或 FTP）中是非常重要的部分。</li> <li>在不包含会话层（例如 UDP）或者是无法长时间驻留会话层（例如 HTTP）的传输协议中，会话的维持需要依靠在传输数据中的高级别程序。例如，在浏览器和远程主机之间的 HTTP 传输中，HTTP cookie 就会被用来包含一些相关的信息，例如 session ID，参数和权限信息等。</li></ul> <h3 id="tcp-会话"><a href="#tcp-会话" class="header-anchor">#</a> TCP 会话</h3> <p>通常是通过子进程和（或）多线程在软件中实现的，当计算机创建或者加入一个会话时即创建一个新的进程或线程。</p> <h3 id="http-会话"><a href="#http-会话" class="header-anchor">#</a> HTTP 会话</h3> <p>通常不会针对每个会话创建一个线程，而是由一个储存每个会话状态信息的数据库实现的。</p> <h3 id="服务器端的会话"><a href="#服务器端的会话" class="header-anchor">#</a> 服务器端的会话</h3> <ul><li>快速而高效，但在负载均衡系统和高速应用系统中使用较麻烦，而在没有储存能力的系统上更是无法使用。</li> <li>在负载均衡系统中可以通过共享储存或者设立独立的存储服务器来解决，这需要根据系统的效率和加载分布的需求情况。</li> <li>使用缓存存储会话数据是一种不需要储存介质的解决方案。</li> <li>这种方式适合于处理少量数据的客户端操作（例如路由或网络桥接器对多个客户端产生的请求）。</li> <li>但是这种方式会消耗较多内存空间。</li></ul> <h3 id="客户端的会话"><a href="#客户端的会话" class="header-anchor">#</a> 客户端的会话</h3> <p>客户端会话使用了 Cookie 和加密技术来完成上面提到的数据储存需求。</p> <h3 id="服务器端会话和客户端的协作"><a href="#服务器端会话和客户端的协作" class="header-anchor">#</a> 服务器端会话和客户端的协作</h3> <ul><li>在动态页面完成解析的时候，储存在会话中的变量会被压缩后传输给客户端的 Cookie。此时完全依靠客户端的文件系统来保存这些数据（或者内存）。</li> <li>在每一个成功的请求中，Cookie 中都保存有服务器端用户所具有的身份证明（PHP 中的 session id）或者更为完整的数据。</li> <li>虽然这样的机制可以保存数据的前后关联，但是必须要保障数据的完整性和安全性。</li></ul> <h2 id="session-原理"><a href="#session-原理" class="header-anchor">#</a> Session 原理</h2> <ul><li>服务器端声明一个 hash 给用户名 ID 一个命名空间。</li> <li>每个用户名 ID 对应一个随机数/或某种加密手段处理过的一串字符串。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> Sessions <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> a <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">radom</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100000</span><span class="token punctuation">;</span>
Sessions<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">XXXID</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>这样通过一串随机数或加密字符串的 Cookie，在服务器通过该 hash 拿到用户名，在通过用户名在数据库中拿到用户数据，起到安全作用。</li> <li>Sessions 相当于服务端的一个内存空间，而 Cookie 则为浏览器客户端硬盘的一个内存空间，两者可以相互配合使用。</li> <li>随机数已经起到了安全性的作用，但是还是有很小的机率会出现重复，这时候可以考虑混入时间戳/用户 IP 等使得这串字符串更具有唯一性。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 取到当下时间（秒）</span>
<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="uid-生成算法方案"><a href="#uid-生成算法方案" class="header-anchor">#</a> UID 生成算法方案</h3> <ul><li><p>ID 是一个系统内用户的唯一标识，其特性: 唯一性、可公开广播、存在可能价值等。</p></li> <li><p>流行的生成方式：摘自<a href="https://segmentfault.com/a/1190000023588832" target="_blank" rel="noopener noreferrer">用户 UID 的几种生成方案及优缺点——网友 boywus<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li>随机生成-普通查重模式</li> <li>经典表 ID 自增模式</li> <li>号池模式</li> <li>随机生成-查重模式-加位法</li> <li>类 Snowflake 模式</li> <li>UUID 模式</li></ul></li></ul> <h4 id="随机生成-普通查重模式"><a href="#随机生成-普通查重模式" class="header-anchor">#</a> 随机生成-普通查重模式</h4> <p>使用 rand 函数随机成生，再去 user 表上查重，不重复就作为用户的 UID，重复则继续 rand 到不重复为止。</p> <ul><li>优点: 生成速度快、逻辑简单、生成号段格式可以通过过滤器控制。</li> <li>缺点: 当用户总数变高的时候，重复率会变高。</li> <li>适用: 用户总量不会很高，对于靓号没有什么要求。</li></ul> <h4 id="经典表-id-自增"><a href="#经典表-id-自增" class="header-anchor">#</a> 经典表 ID 自增</h4> <p>将 user 表的 id 设置为 auto_increment，插入会自动生成 ID，将表的主键 ID 作为 UID。</p> <ul><li>优点: 不需要主动管理，自动生成，不会重复。</li> <li>缺点: 容易暴露系统的真实用户数，不适合需要良好数据的商业公司。</li> <li>适用: 普通的社区、博客内容等不关注 UID 模式的系统。</li></ul> <h4 id="号池模式"><a href="#号池模式" class="header-anchor">#</a> 号池模式</h4> <p>生成一批 UID 存放到号池内， 注册一个取走一个。</p> <ul><li>优点: 对于靓号的控制精准、号池控制得当的话，不会发生重复。</li> <li>缺点: 对于号池服务的稳定性很高, 对于号池内数据的增加和删除需要主动管理，否则会发生重复。</li> <li>适用: 对靓号要求控制严格，适用于一般的等级荣誉感、靓号荣誉感较高的玩家社区。</li></ul> <h4 id="随机生成-查重模式-加位法"><a href="#随机生成-查重模式-加位法" class="header-anchor">#</a> 随机生成-查重模式-加位法</h4> <p>加位查重法是普通查重法的升级，当碰到了重复号码的时候，向号码尾部增加一个随机数字，如果重复就继续增加，直到不重复为止。</p> <ul><li>优点: 相对于普通查重法，重复后的再次获取次数可以减少</li> <li>缺点: 重复后再获取率随着用户数上升，也会遭遇瓶颈。</li> <li>适用: 同普通查重模式。</li></ul> <h4 id="类-snowflake-模式"><a href="#类-snowflake-模式" class="header-anchor">#</a> 类 Snowflake 模式</h4> <ul><li><p>Snowflake 是一个经典的号段生成算法，同时市面上存在大量的 XXXflake 算法，一般用作订单号。</p></li> <li><p>Snowflake 的原理：使用 41bit 作为毫秒数，10bit 作为机器的 ID（5 个 bit 是数据中心，5 个 bit 的机器 ID），12bit 作为毫秒内的流水号，最后还有一个符号位，永远是 0。</p> <ul><li>优点: 不需要主动管理就可保证防重性，可以根据业务配比调整 bit。</li> <li>缺点: 生成的数据结果比较长，索引需要主动优化。</li> <li>适用: 不存在 UID 靓号需求</li></ul></li></ul> <h4 id="uuid-模式"><a href="#uuid-模式" class="header-anchor">#</a> UUID 模式</h4> <p>UUID 是一个国际标准算法，优缺点和类 Snowflake 一致</p> <ul><li>优点: 不需要主动管理就可保证防重性。</li> <li>缺点: 生成的数据结果比较长，索引需要主动优化。</li> <li>适用: 不存在 UID 靓号需求</li></ul> <h2 id="cookie-和-session-总结"><a href="#cookie-和-session-总结" class="header-anchor">#</a> Cookie 和 Session 总结</h2> <h3 id="cookie"><a href="#cookie" class="header-anchor">#</a> Cookie</h3> <ol><li>服务器通过 Set-Cookie 头给客户端一串字符串</li> <li>客户端每次访问相同域名的网页时，必须带上这段字符串</li> <li>客户端要在一段时间内保存这个 Cookie</li> <li>Cookie 默认在用户关闭页面后就失效，后台代码可以任意设置 Cookie 的过期时间</li> <li>大小大概在 4kb 以内</li></ol> <h3 id="session"><a href="#session" class="header-anchor">#</a> Session</h3> <ol><li>将 SessionID（随机数）通过 Cookie 发给客户端</li> <li>客户端访问服务器时，服务器读取 SessionID</li> <li>服务器有一块内存（哈希表）保存了所有 session</li> <li>通过 SessionID 我们可以得到对应用户的隐私信息，如 id、email</li> <li>这块内存（哈希表）就是服务器上的所有 session</li></ol> <hr> <p><em>Copyright © 2020 - 2021 by 叶旭瑶 . All Rights Reserved .</em></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/[05]Cookie与浏览器HTTP缓存控制.html" class="prev">
        [05]Cookie与浏览器HTTP缓存控制
      </a></span> <span class="next"><a href="/我的学习笔记/04-蒂姆·伯纳斯·李Browser/[07]LocalStorage与SessionStorage的使用.html">
        [07]LocalStorage与SessionStorage的使用
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.a8df1c95.js" defer></script><script src="/assets/js/2.48d09664.js" defer></script><script src="/assets/js/40.c28128a5.js" defer></script>
  </body>
</html>
